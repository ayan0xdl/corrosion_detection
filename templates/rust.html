{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>RustVision – Automated Corrosion Detection</title>
  <link rel="stylesheet" href="{% static 'rust.css' %}">
</head>

<body>
  <main>

    <!-- ===== NAVBAR ===== -->
    <header class="navbar">
      <nav class="navbar-container">
        <ul class="nav-menu">
          <li><a href="/" class="nav-link">Home</a></li>
          <li><a href="/about" class="nav-link">About</a></li>
          <li><a href="/process" class="nav-link">Process</a></li>
        </ul>
        <a href="/" class="nav-logo">RustVision</a>
      </nav>
    </header>

    <!-- ===== MAIN ===== -->
    <div class="container">

      <h1>RustVision</h1>

      <p class="intro-text">
        RustVision is an AI-powered computer vision system for automated corrosion
        detection in industrial infrastructure. Upload an image to analyze surface
        degradation and visualize corrosion regions.
      </p>

      <!-- ===== UPLOAD FORM ===== -->
      <form method="POST" action="/detect/" enctype="multipart/form-data" class="upload-wrapper">
        {% csrf_token %}
        <input type="file" id="imageInput" name="image" class="file-input" accept="image/*" multiple required>

        <label for="imageInput" class="upload-box">
          <span class="upload-text">Upload Image</span>
        </label>

        <button type="submit" class="detect-btn">
          Detect Corrosion
        </button>
      </form>

      <!-- ===== WELCOME ===== -->
      {% if not original_image_url %}
      <div class="welcome-section">
        <p>Select an image to begin the inspection.</p>
      </div>
      {% endif %}

      {% if evaluations %}
      <section class="result-panel">
        <div class="results-container multiple-images">
          {% for eval in evaluations %}
          <div class="result-card">
            <h3>Inspection #{{ forloop.counter }}</h3>

            <div class="image-item">
              <h4>Original Image</h4>
              <div class="image-wrapper">
                <img src="{{ eval.original_url }}" alt="Original" />
              </div>
            </div>

            <div class="image-item">
              <h4>Detected Corrosion</h4>
              <div class="image-wrapper">
                <img src="{{ eval.detected_url }}" alt="Detected" />
              </div>
              <a href="{{ eval.detected_url }}" class="download-btn" download style="margin-top:1rem;">
                Download Image
              </a>
            </div>

            <div style="margin-top:1rem; text-align:center;">
              <p style="color:#ddd; margin-bottom:5px;">Confidence: <strong>{{ eval.confidence }}%</strong></p>
            </div>
          </div>
          {% endfor %}
        </div>

        <div style="margin-top:3rem; display:flex; gap:1rem; justify-content:center; flex-wrap:wrap;">
          {% if evaluations_count == 1 %}
          <a href="/report/single/" class="download-btn">Download Report (PDF)</a>
          {% else %}
          <a href="/report/multiple/" class="download-btn">Download Full PDF Report</a>
          {% endif %}

          <a href="/clear/" class="download-btn clear-btn">Clear Results</a>
        </div>
    </div>
    </section>
    {% endif %}

    </div>

    <footer class="footer">
      <p>© 2026 RustVision · AI for Industrial Inspection</p>
    </footer>

  </main>

  <script src="{% static 'rust.js' %}"></script>
</body>

</html>